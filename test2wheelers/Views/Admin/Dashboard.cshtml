@using System.Security.Claims
@using _2whealers.Models
@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_Admin_Layout.cshtml";

    var userName = User.FindFirst(ClaimTypes.Name)?.Value ?? "User";
    var roleId = User.FindFirst(ClaimTypes.Role)?.Value;
}
<ol class="breadcrumb mb-0">
    <li class="breadcrumb-item">
        <a href="/Admin/Dashboard">
            <i class="fas fa-home"> </i>
            Home
        </a>
    </li>
</ol>

<div class="content-header">
    <div class="container-fluid">
        <div class="row mb-2">
            <div class="col-sm-6">
                <h1 class="m-0"> <i class="nav-icon fas fa-tachometer-alt"> Dashboard </i> </h1>
            </div>
        </div>
    </div>
</div>
<section class="content">
    <div class="container-fluid">
        <!-- Welcome Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-info shadow-sm" role="alert">
                    <h4 class="mb-1">Welcome back, <strong>@userName</strong>!</h4>
                    <p class="mb-0">Here is your dashboard overview.</p>
                </div>
            </div>
        </div>

        <div class="row">
            @* SuperAdmin Regions *@
            @if (roleId == "1")
            {
                <h5 class="col-12 mb-3 text-primary">Branch Overview</h5>
                @foreach (var region in ViewBag.Regions as List<RegionModel>)
                {
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                        <a href="@Url.Action("RegionDashboard", "Admin", new { regionId = region.RegionId })" style="text-decoration:none;">
                            <div class="small-box bg-info text-white shadow-sm hover-shadow">
                                <div class="inner p-3">
                                    <h3>@region.RegionName</h3>
                                    <p>Click to view Sales & Pre-Sales</p>
                                </div>
                                <div class="icon">
                                    <i class="fas fa-map-marker-alt"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                }
            }
            else
            {
                @* Normal User Cards *@
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="small-box bg-success text-white shadow-sm">
                        <div class="inner p-3">
                            <h3>@ViewBag.SaleCount</h3>
                            <p>Sales</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-bag"></i>
                        </div>
                        <a href="@Url.Action("Sales", "Admin")" class="small-box-footer">
                            More info <i class="fas fa-arrow-circle-right"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="small-box bg-warning text-white shadow-sm">
                        <div class="inner p-3">
                            <h3>@ViewBag.PreSaleCount</h3>
                            <p>Pre-Sales</p>
                        </div>
                        <div class="icon">
                            <i class="ion ion-stats-bars"></i>
                        </div>
                        <a href="@Url.Action("PreSales", "Admin")" class="small-box-footer">
                            More info <i class="fas fa-arrow-circle-right"></i>
                        </a>
                    </div>
                </div>
            }
        </div>
    </div>
</section>

<style>
    .hover-shadow:hover {
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        transition: 0.3s;
    }

    .small-box {
        border-radius: 0.5rem;
        position: relative;
        display: block;
        color: #fff;
        padding: 20px;
    }

        .small-box .icon {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 2.5rem;
            opacity: 0.4;
        }

    .alert-info {
        border-radius: 0.5rem;
    }
</style>
